<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The KetoFit Program</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        .language-switch { margin-bottom: 20px; }
        .quiz, .results { display: none; }
        .quiz.active, .results.active { display: block; }
        [lang]:not(.active) { display: none !important; }
        button { padding: 10px; margin: 5px; }
        .error { color: red; }
        .links { margin-top: 20px; }
        a { margin-right: 10px; }
    </style>
</head>
<body>
    <!-- Force Rebuild: 2025-06-21 12:05 EDT -->
    <div class="container">
        <div class="language-switch">
            <button data-lang="en" onclick="switchLanguage('en')">English</button>
            <button data-lang="zh" onclick="switchLanguage('zh')">简体中文</button>
        </div>

        <h1 lang="en">Welcome to The KetoFit Program</h1>
        <h1 lang="zh">欢迎体验 KetoFit 计划</h1>
        <p lang="en">Discover a sustainable path to your ideal weight, toned physique, and lean body with our Keto-carnivore based meal and exercise plans, powered by big data and AI.</p>
        <p lang="zh">通过我们的 Keto-carnivore 饮食和锻炼计划，结合大数据和人工智能技术，探索通往理想体重、紧实身材和健美身形的可持续路径。</p>
        <button data-action="quiz" lang="en" onclick="showQuiz()">Take the Quiz</button>
        <button data-action="quiz" lang="zh" onclick="showQuiz()">开始测评</button>

        <div id="quiz" class="quiz">
            <h2 lang="en">Personal Assessment Quiz</h2>
            <h2 lang="zh">个人评估测评</h2>
            <form id="assessmentForm">
                <label lang="en">Gender: 
                    <select name="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </label>
                <label lang="zh">性别: 
                    <select name="gender" required>
                        <option value="male">男</option>
                        <option value="female">女</option>
                        <option value="other">其他</option>
                    </select>
                </label><br>
                <label lang="en">Age: <input type="number" name="age" min="18" max="100" required></label>
                <label lang="zh">年龄: <input type="number" name="age" min="18" max="100" required></label><br>
                <label lang="en">Height (cm): <input type="number" name="height" required></label>
                <label lang="zh">身高 (厘米): <input type="number" name="height" required></label><br>
                <label lang="en">Weight (kg): <input type="number" name="weight" required></label>
                <label lang="zh">体重 (公斤): <input type="number" name="weight" required></label><br>
                <label lang="en">Activity Level: 
                    <select name="activityLevel" required>
                        <option value="everyday">Every day</option>
                        <option value="1-2week">1-2 times a week</option>
                        <option value="couplemonth">A couple times a month</option>
                    </select>
                </label>
                <label lang="zh">活动水平: 
                    <select name="activityLevel" required>
                        <option value="everyday">每天</option>
                        <option value="1-2week">每周1-2次</option>
                        <option value="couplemonth">每月几次</option>
                    </select>
                </label><br>
                <label lang="en">Body Type: 
                    <select name="bodyType" required>
                        <option value="overweight">Overweight</option>
                        <option value="chubbysoft">Chubby/Soft</option>
                        <option value="slim">Slim</option>
                        <option value="skinny">Skinny</option>
                    </select>
                </label>
                <label lang="zh">体型: 
                    <select name="bodyType" required>
                        <option value="overweight">超重</option>
                        <option value="chubbysoft">圆润/柔软</option>
                        <option value="slim">苗条</option>
                        <option value="skinny">瘦弱</option>
                    </select>
                </label><br>
                <label lang="en">Fitness Goal: 
                    <select name="goal" required>
                        <option value="idealweight">Ideal Weight</option>
                        <option value="toneup">Tone Up</option>
                        <option value="getlean">Get Lean</option>
                    </select>
                </label>
                <label lang="zh">健身目标: 
                    <select name="goal" required>
                        <option value="idealweight">理想体重</option>
                        <option value="toneup">紧实身材</option>
                        <option value="getlean">减脂</option>
                    </select>
                </label><br>
                <label lang="en">Meal Preferences (e.g., beef, pork, chicken): <input type="text" name="mealPrefs" placeholder="e.g., beef, pork" required></label>
                <label lang="zh">饮食偏好 (如牛肉, 猪肉, 鸡肉): <input type="text" name="mealPrefs" placeholder="如牛肉, 猪肉" required></label><br>
                <button type="submit" lang="en">Submit</button>
                <button type="submit" lang="zh">提交</button>
            </form>
            <p class="error" id="jsError" style="display:none;">JavaScript is required for this quiz. Please enable it in your browser or check the console for errors.</p>
        </div>

        <div id="results" class="results">
            <h2 lang="en">Your Personalized KetoFit Plan</h2>
            <h2 lang="zh">您的个性化 KetoFit 计划</h2>
            <p id="planDetails" lang="en"></p>
            <p id="planDetails" lang="zh"></p>
            <a id="downloadLink" href="#" download="KetoFit_Plan.pdf" lang="en">Download Plan</a>
            <a id="downloadLink" href="#" download="KetoFit_Plan.pdf" lang="zh">下载计划</a>
        </div>

        <div id="about">
            <h2 lang="en">About Us</h2>
            <h2 lang="zh">关于我们</h2>
            <p lang="en">The KetoFit Program is rooted in the Keto-carnivore philosophy, emphasizing high animal protein, low to moderate carbs, and high to moderate fats. This approach, backed by cutting-edge nutritional science from sources like the Journal of Nutrition and the American Journal of Clinical Nutrition, leverages big data and AI to optimize meal and exercise plans for sustainable health and fitness. Unlike restrictive fad diets, KetoFit uses evidence-based strategies to enhance metabolic health, muscle retention, and fat loss, suitable for all ages, genders, and fitness levels. Our plans, inspired by global research, ensure long-term success by aligning with individual needs, making it the answer for a healthier, more vibrant you.</p>
            <p lang="zh">KetoFit 计划以 Keto-carnivore 哲学为基础，强调高动物蛋白、低到中等碳水化合物和高到中等脂肪。这一方法得到《营养学杂志》和《美国临床营养学杂志》等尖端营养科学的支持，利用大数据和人工智能优化饮食和锻炼计划，以实现可持续的健康和健身。与限制性时尚饮食不同，KetoFit 使用基于证据的策略来增强代谢健康、肌肉保留和脂肪减少，适合所有年龄、性别和健身水平。我们的计划受到全球研究的启发，确保与个人需求保持一致，使其成为您更健康、更充满活力的答案。</p>
        </div>

        <div class="links">
            <a href="privacy.html" lang="en">Privacy Policy</a>
            <a href="privacy.html" lang="zh">隐私政策</a>
            <a href="terms.html" lang="en">Terms of Use</a>
            <a href="terms.html" lang="zh">使用条款</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentLang = 'en';

            function switchLanguage(lang) {
                if (!lang || lang === currentLang) return;
                currentLang = lang;
                const elements = document.querySelectorAll('[lang]');
                elements.forEach(el => {
                    el.classList.remove('active');
                    if (el.getAttribute('lang') === lang) {
                        el.classList.add('active');
                        console.log(`Activated ${lang} element:`, el.tagName);
                    }
                });
                console.log(`Switched to ${lang} - Active elements:`, document.querySelectorAll('[lang].active').length);
            }

            function showQuiz() {
                const quiz = document.getElementById('quiz');
                if (quiz) {
                    quiz.classList.add('active');
                    console.log('Quiz displayed successfully');
                } else {
                    console.error('Quiz element not found');
                    document.getElementById('jsError').style.display = 'block';
                }
            }

            // Attach event listeners to language buttons
            document.querySelectorAll('[data-lang]').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = button.getAttribute('data-lang');
                    if (lang) {
                        switchLanguage(lang);
                    } else {
                        console.error('No data-lang attribute on button', button);
                    }
                });
            });

            // Attach event listener to quiz buttons
            document.querySelectorAll('[data-action="quiz"]').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    showQuiz();
                });
            });

            // Handle form submission
            const assessmentForm = document.getElementById('assessmentForm');
            if (assessmentForm) {
                assessmentForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('Form submitted, data:', this.elements);
                    const formData = new FormData(this);
                    const data = Object.fromEntries(formData);

                    // Validate required fields
                    const requiredFields = ['weight', 'height', 'age', 'gender', 'activityLevel', 'bodyType', 'goal', 'mealPrefs'];
                    const missingFields = requiredFields.filter(field => !data[field]);
                    if (missingFields.length > 0) {
                        console.error('Missing required fields:', missingFields);
                        document.getElementById('jsError').style.display = 'block';
                        return;
                    }

                    // Convert numeric fields to floats
                    const numericData = {
                        weight: parseFloat(data.weight),
                        height: parseFloat(data.height),
                        age: parseFloat(data.age)
                    };
                    if (Object.values(numericData).some(value => isNaN(value))) {
                        console.error('Invalid numeric data:', numericData);
                        document.getElementById('jsError').style.display = 'block';
                        return;
                    }

                    // Calculate nutrition and activity targets
                    let proteinTarget = numericData.weight * 0.8;
                    let carbLimit = 50;
                    let fatTarget = (numericData.weight * 0.5) / 9;
                    let activityFactor = {
                        'everyday': 1.5,
                        '1-2week': 1.2,
                        'couplemonth': 1.0
                    }[data.activityLevel] || 1.0;
                    let calories = (numericData.weight * 25 * activityFactor) + (proteinTarget * 4) + (carbLimit * 4) + (fatTarget * 9);

                    // Generate meal plan
                    let mealPlan = generateMealPlan(data.mealPrefs.split(',').map(p => p.trim()), data.goal);
                    // Generate exercise plan
                    let exercisePlan = generateExercisePlan(data.activityLevel, data.goal);

                    // Display results
                    const planDetailsEn = document.querySelector('#planDetails[lang="en"]');
                    const planDetailsZh = document.querySelector('#planDetails[lang="zh"]');
                    const downloadLink = document.getElementById('downloadLink');
                    if (planDetailsEn && planDetailsZh && downloadLink) {
                        planDetailsEn.innerHTML = `
                            <h3>Meal Plan</h3><p>Target: ${proteinTarget.toFixed(1)}g protein, ${carbLimit}g carbs, ${fatTarget.toFixed(1)}g fat daily. Calories: ${calories.toFixed(0)}.<br>${mealPlan}</p>
                            <h3>Exercise Plan</h3><p>${exercisePlan}</p>
                            <p>Payment required to download. Click <a href="mailto:support@ketofit.com?subject=Purchase Plan">here</a> to pay and receive your plan via email.</p>
                        `;
                        planDetailsZh.innerHTML = `
                            <h3>饮食计划</h3><p>目标: 每日 ${proteinTarget.toFixed(1)}克蛋白质，${carbLimit}克碳水化合物，${fatTarget.toFixed(1)}克脂肪。热量: ${calories.toFixed(0)}。<br>${mealPlan}</p>
                            <h3>锻炼计划</h3><p>${exercisePlan}</p>
                            <p>需要支付才能下载。点击<a href="mailto:support@ketofit.com?subject=Purchase Plan">这里</a>支付并通过电子邮件接收您的计划。</p>
                        `;
                        document.getElementById('results').classList.add('active');
                        downloadLink.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(`KetoFit Plan\n\n${currentLang === 'en' ? planDetailsEn.innerHTML : planDetailsZh.innerHTML}`);
                        console.log('Plan generated and displayed');
                    } else {
                        console.error('Plan details or download link not found:', { planDetailsEn, planDetailsZh, downloadLink });
                        document.getElementById('jsError').style.display = 'block';
                    }
                });
            } else {
                console.error('Assessment form not found');
                document.getElementById('jsError').style.display = 'block';
            }

            function generateMealPlan(preferences, goal) {
                const meals = {
                    breakfast: ['Scrambled Eggs with Bacon (20g protein, 2g carbs, 15g fat, 20m)', 'Keto Cottage Cheese Pancakes (15g protein, 5g carbs, 10g fat, 25m)'],
                    lunch: ['Beef Stir-Fry with Broccoli (25g protein, 10g carbs, 20g fat, 30m)', 'Chicken Thigh with Spinach (30g protein, 5g carbs, 25g fat, 35m)'],
                    dinner: ['Pork Ribs with Cauliflower Mash (35g protein, 8g carbs, 30g fat, 40m)', 'Salmon with Asparagus (28g protein, 6g carbs, 22g fat, 35m)'],
                    dessert: ['Cream Cheese Fat Bombs (5g protein, 2g carbs, 15g fat, 15m)', 'Cottage Cheese Chocolate Mousse (10g protein, 4g carbs, 12g fat, 20m)']
                };
                return `Sample Day: ${meals.breakfast[0]}, ${meals.lunch[1]}, ${meals.dinner[0]}, ${meals.dessert[1]}. Adjust based on ${preferences.join(', ')} and ${goal}. All meals use China-available ingredients.`;
            }

            function generateExercisePlan(activityLevel, goal) {
                const exercises = {
                    warmup: ['Jumping Jacks (2m)', 'Arm Circles (2m)'],
                    bodyweight: ['Squats (3x15)', 'Push-Ups (3x10)', 'Plank (3x30s)'],
                    gym: ['Leg Press (3x12)', 'Bench Press (3x10)', 'Lat Pulldown (3x12)']
                };
                return `Warm-up: ${exercises.warmup[0]}. Bodyweight: ${exercises.bodyweight.join(', ')} (${activityLevel} frequency). Gym Option: ${exercises.gym.join(', ')}. Focus: ${goal}, adaptable for all fitness levels.`;
            }

            // Initialize with English
            document.querySelectorAll('[lang="en"]').forEach(el => el.classList.add('active'));
        });
    </script>
</body>
</html>
